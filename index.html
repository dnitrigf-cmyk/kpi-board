<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KPI Board</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<!-- —Å—Ç–∞—Ä—Ç—É–µ–º –≤ —Ç—ë–º–Ω–æ–π —Ç–µ–º–µ -->
<body class="theme-dark">
  <header>
    <h1>KPI Board</h1>
    <span class="tag">Firebase Shared</span>

    <!-- –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
    <button id="themeToggle" class="app-menu-btn" title="Switch theme">‚òÄÔ∏è / üåô</button>
  </header>

  <main>
    <aside class="side">
      <div class="group">
        <button>This department</button>
        <button>All departments</button>
      </div>
      <!-- —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö –º–∏–Ω–∏-–ø—Ä–æ–≥—Ä–µ—Å—Å -->
      <div class="users-summary"></div>
    </aside>

    <section class="grid-wrap">
      <!-- —Å—Ç—Ä–µ–ª–∫–∏-–Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
      <div class="nav-arrows">
        <button class="nav-btn" id="btnBackLevel" title="Back">‚Üê</button>
        <button class="nav-btn" id="btnHome" title="Months">‚åÇ</button>
      </div>

      <!-- –ø–∞–Ω–µ–ª—å prev/next -->
      <div class="head-controls">
        <button class="hc-btn" id="hcPrev">‚Üê</button>
        <div class="hc-spacer"></div>
        <button class="hc-btn" id="hcNext">‚Üí</button>
      </div>

      <!-- —Ç–∞–±–ª–∏—Ü–∞ KPI -->
      <table>
        <thead>
          <tr id="theadRow">
            <th style="min-width:240px;">KPI name</th>
            <th style="min-width:150px;">Target</th>
            <!-- –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–º–µ—Å—è—Ü—ã/–Ω–µ–¥–µ–ª–∏/–¥–Ω–∏) –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º -->
          </tr>
        </thead>
        <tbody id="tbody">
          <!-- —Å—Ç—Ä–æ–∫–∏ KPI –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º -->
        </tbody>
      </table>

      <!-- –Ω–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
      <div class="usersbar">
        <div id="users"></div>
      </div>
    </section>
  </main>

  <!-- –∫–æ—Ä–µ–Ω—å –≤—Å–µ—Ö –º–æ–¥–∞–ª–æ–∫ -->
  <div id="modal-root"></div>

  <!-- ===== THEME ENGINE (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π) ===== -->
  <script>
  (function(){
    const KEY = 'kpi-theme';
    const root = document.body;

    // –ø—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    const saved = localStorage.getItem(KEY) || 'dark';
    root.classList.remove('theme-light','theme-dark');
    root.classList.add(saved === 'light' ? 'theme-light' : 'theme-dark');

    // –¥–æ—Å—Ç—É–ø–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    window.toggleTheme = function(){
      const next = root.classList.contains('theme-light') ? 'dark' : 'light';
      root.classList.remove('theme-light','theme-dark');
      root.classList.add(next === 'light' ? 'theme-light' : 'theme-dark');
      localStorage.setItem(KEY, next);
    };
  })();

  // –Ω–∞–≤–µ—à–∏–≤–∞–µ–º –Ω–∞ –∫–Ω–æ–ø–∫—É –∏ –¥–µ—Ä–∂–∏–º, –¥–∞–∂–µ –µ—Å–ª–∏ DOM –ø–µ—Ä–µ—Ä–∏—Å—É–µ—Ç—Å—è
  (function bindThemeButton(){
    function attach(){
      const btn = document.getElementById('themeToggle');
      if (btn && !btn.__themeBound){
        btn.__themeBound = true;
        btn.addEventListener('click', window.toggleTheme);
      }
    }
    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', attach);
    else attach();
    new MutationObserver(attach).observe(document.documentElement, {childList:true,subtree:true});
  })();
  </script>

  <script defer src="app.js"></script>
</body>
</html>
